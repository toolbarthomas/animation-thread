<!doctype html>
<html>

<head>
  <title>requestAnimationThread</title>

  <style>
    body {
      background: #4d4d4d;
    }

    .block {
      width: 100px;
      height: 100px;
      border: solid 6px white;
      background-color: beige;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 300%;
    }
  </style>

  <script type="module">
    import { requestAnimationThread } from "./index.js";

    function create(fps, strict, foo)
    {

      const element = document.createElement('div');
      element.classList.add('block');
      element.innerText = fps;
      document.body.append(element);
      let value = 0;
      let paused = false;
      let sum = 0;


      const pause = document.createElement('button')
      pause.innerText = "Pause";
      pause.onclick = () =>
      {
        element.innerText = 0
        thread.pause()
      };
      const resume = document.createElement('button')
      resume.innerText = "Resume";
      resume.onclick = () => thread.resume();



      const resume30 = document.createElement('button')
      resume30.innerText = "Resume to 30";
      resume30.onclick = () => thread.resume(30);

      const fpsInfo = document.createElement('button')
      fpsInfo.innerText = "FPS";
      fpsInfo.onclick = () => console.log(thread.fps());

      const intervalInfo = document.createElement('button')
      intervalInfo.innerText = "Interval";
      intervalInfo.onclick = () => console.log(thread.interval());


      const ten = document.createElement('button')
      ten.innerText = "5";
      ten.onclick = () => console.log(thread.throttle(5));

      const restore = document.createElement('button')
      restore.innerText = "Restore";
      restore.onclick = () => console.log(thread.restore());

      document.body.appendChild(pause);
      document.body.appendChild(resume);
      document.body.appendChild(resume30);
      document.body.appendChild(fpsInfo);
      document.body.appendChild(intervalInfo);
      document.body.appendChild(ten);
      document.body.appendChild(restore);

      const thread = requestAnimationThread((response) =>
      {
        const length = 10;
        element.style.marginLeft = `${value}px`
        element.innerText = thread.fps()
        const n = Math.round(response.multiplier * 100) / 100
        sum += Math.floor(length * n);
        //@TODO should resolve relative value;
        if (strict) {
          value += response.multiplier * length;
        } else {
          value += length;
        }

        if (value > 600) {
        }
      }, fps, { limit: 7, strict })
      if (foo) {
        thread.throttle(foo)
      }
      // thread.throttle(20)
    }

    // create(10);
    // create(5, false);
    // create(10, false, 5);

    create(10, true, 20);
    create(10, true, 5);
    create(10, true);
    // create(10, true, 20);
    // create(10, true, 40);


    // create(60);


  </script>
</head>

<body>

</body>

</html>